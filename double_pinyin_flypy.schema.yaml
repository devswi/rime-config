# Rime schema
# encoding: utf-8

schema:
  schema_id: double_pinyin_flypy
  name: å°é¹¤åŒæ‹¼
  version: "2023-12-18"
  author:
    - double pinyin layout by é¶´
    - Rime schema by ä½›æŒ¯ <chen.sst@gmail.com>
    - Modified by Lufs_X <i@isteed.cc>
  description: |
    å°é¹¤åŒæ‹¼æ–¹æ¡ˆã€‚
    ç¨å¾®çš„æ”¹äº†ä¸€ä¸‹ï¼ˆå°å£°

switches:
  - name: ascii_mode
    states: [ ä¸­, ï¼¡ ]
  - name: ascii_punct  # ä¸­è‹±æ ‡ç‚¹
    states: [ Â¥, $ ]
  - name: traditionalization
    states: [ ç®€, ç¹ ]
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
    reset: 1
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]

# è¾“å…¥å¼•æ“
engine:
  processors:
    - lua_processor@*select_character  # ä»¥è¯å®šå­—
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - affix_segmentor@radical_lookup  # éƒ¨ä»¶æ‹†å­—è‡ªå®šä¹‰ tag
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
    - lua_translator@*date_translator    # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
    - lua_translator@*lunar              # å†œå†
    - table_translator@custom_phrase     # è‡ªå®šä¹‰çŸ­è¯­ custom_phrase_double.txt
    - table_translator@melt_eng          # è‹±æ–‡è¾“å…¥
    - table_translator@cn_en             # ä¸­è‹±æ··åˆè¯æ±‡
    - table_translator@radical_lookup    # éƒ¨ä»¶æ‹†å­—åæŸ¥
    - lua_translator@*unicode            # Unicode
    - lua_translator@*number_translator  # æ•°å­—ã€é‡‘é¢å¤§å†™
    - lua_translator@*calc_translator    # è®¡ç®—å™¨
    - lua_translator@*force_gc           # æš´åŠ› GC
  filters:
    - lua_filter@*corrector                         # é”™éŸ³é”™å­—æç¤º
    - reverse_lookup_filter@radical_reverse_lookup  # éƒ¨ä»¶æ‹†å­—æ»¤é•œ
    - lua_filter@*autocap_filter                    # è‹±æ–‡è‡ªåŠ¨å¤§å†™
    - lua_filter@*pin_cand_filter                   # ç½®é¡¶å€™é€‰é¡¹ï¼ˆé¡ºåºè¦æ±‚ï¼šç½®é¡¶å€™é€‰é¡¹ > Emoji > ç®€ç¹åˆ‡æ¢ï¼‰
    - lua_filter@*reduce_english_filter             # é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
    - simplifier@emoji                              # Emoji
    - simplifier@traditionalize                     # ç®€ç¹åˆ‡æ¢
    - lua_filter@*search@radical_pinyin             # éƒ¨ä»¶æ‹†å­—è¾…ç 
    - uniquifier                                    # å»é‡


traditionalize:
  option_name: traditionalization
  opencc_config: s2t.json # s2t.json | s2hk.json | s2tw.json | s2twp.json
  tips: none # è½¬æ¢æç¤º: all æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚

emoji_suggestion:
  opencc_config: emoji.json
  option_name: emoji_suggestion
  tips: false

speller:
  alphabet: zyxwvutsrqponmlkjihgfedcba/
  delimiter: " '"
  algebra:
    - erase/^xx$/
    - erase/^hm$/
    - erase/^m$/
    - erase/^n$/
    - erase/^ng$/

    # æ¨¡ç³ŠéŸ³åŒºåŸŸ
    # ä¾æ®ä¸ªäººæƒ…å†µä¿®æ”¹æ³¨é‡Šï½
    # æ³¨é‡Šæ ¼å¼ï¼šé”®ç›˜çš„è¾“å…¥ç  -> è½¬åŒ–åçš„è¾“å…¥ç 

    # å£°æ¯éƒ¨åˆ†
    # - derive/^([z])h/$1/ # z -> zh
    # - derive/^([z])([^h])/$1h$2/ # zh -> z
    # - derive/^([c])h/$1/ # c -> ch
    # - derive/^([c])([^h])/$1h$2/ # ch -> c
    # - derive/^([s])h/$1/ # s -> sh
    # - derive/^([s])([^h])/$1h$2/ # sh -> s
    # - derive/^l/n/ # n -> l
    # - derive/^n/l/ # l -> n
    # - derive/^r/l/ # l -> r
    # - derive/^r/y/ # y -> r
    # - derive/^hu$/fu/ # fu -> hu
    # - derive/^fu$/hu/ # hu -> fu

    # éŸµæ¯éƒ¨åˆ†
    - derive/([^iu])([a])n$/$1$2ng/ # ang -> an
    - derive/([^iu])([a])ng$/$1$2n/ # an -> ang
    - derive/([e])n$/$1ng/ # eng -> en
    - derive/([e])ng$/$1n/ # en -> eng
    # - derive/([i])n$/$1ng/ # ing -> in
    # - derive/([i])ng$/$1n/ # in -> ing
    # - derive/([i])an$/$1ang/ # iang -> ian
    # - derive/([i])ang$/$1an/ # ian -> iang
    # ç”±äºå°é¹¤åŒæ‹¼ç‰¹æ€§ï¼Œæ— éœ€ uang <-> iang

    # å…¶å®ƒæ¨¡ç³ŠéŸ³
    # - derive/^hui$/fei/ # fei -> hui
    # - derive/^fei$/hui/ # hui -> fei
    # - derive/^huang$/wang/ # wang -> huang
    # - derive/^wang$/huang/ # huang -> wang
    # - derive/^([bpmfw])eng$/$1ong/ # bpmfw åæ¥ ong -> bpmfw åæ¥ eng

    # å°é¹¤åŒæ‹¼ç è¡¨
    - derive/^([jqxy])u$/$1v/
    - derive/^([aoe])([ioun])$/$1$1$2/
    - xform/^([aoe])(ng)?$/$1$1$2/
    - xform/iu$/Q/
    - xform/(.)ei$/$1W/
    - xform/uan$/R/
    - xform/[uv]e$/T/
    - xform/un$/Y/
    - xform/^sh/U/
    - xform/^ch/I/
    - xform/^zh/V/
    - xform/uo$/O/
    - xform/ie$/P/
    - xform/i?ong$/S/
    - xform/ing$|uai$/K/
    - xform/(.)ai$/$1D/
    - xform/(.)en$/$1F/
    - xform/(.)eng$/$1G/
    - xform/[iu]ang$/L/
    - xform/(.)ang$/$1H/
    - xform/ian$/M/
    - xform/(.)an$/$1J/
    - xform/(.)ou$/$1Z/
    - xform/[iu]a$/X/
    - xform/iao$/N/
    - xform/(.)ao$/$1C/
    - xform/ui$/V/
    - xform/in$/B/
    - xlit/QWRTYUIOPSDFGHJKLZXCVBNM/qwrtyuiopsdfghjklzxcvbnm/

    # ç®€æ‹¼æ”¯æŒ
    - abbrev/^(.).+$/$1/

translator:
  dictionary: extended
  preedit_format:
    # - xform/ // # å»æ‰ä¸Šå±å­—ç¬¦é—´ç©ºæ ¼
  prism: lufs_flypy
  contextual_suggestions: true
  max_homophones: 7

grammar:
  language: zh-hans-t-essay-bgw

punctuator:
  import_preset: lufs_symbols

key_binder:
  import_preset: default

recognizer:
  import_preset: default

custom_phrase:
  dictionary: ""
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: true
  initial_quality: 1
